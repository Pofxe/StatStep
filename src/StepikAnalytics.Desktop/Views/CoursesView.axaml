<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:StepikAnalytics.Desktop.ViewModels"
             x:Class="StepikAnalytics.Desktop.Views.CoursesView"
             x:DataType="vm:CoursesViewModel">
    
    <Grid Background="{StaticResource BackgroundBrush}" Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,24">
            <TextBlock Text="ÐœÐ¾Ð¸ ÐºÑƒÑ€ÑÑ‹"
                       FontSize="32"
                       FontWeight="Bold"
                       Foreground="{StaticResource TextPrimaryBrush}" />
            <TextBlock Text="Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐºÑƒÑ€ÑÑ‹ Stepik Ð´Ð»Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸"
                       FontSize="15"
                       Foreground="{StaticResource TextSecondaryBrush}" />
        </StackPanel>
        
        <!-- Add course form -->
        <Border Grid.Row="1"
                Background="{StaticResource PaperBrush}"
                CornerRadius="12"
                Padding="24"
                Margin="0,0,0,24"
                BorderBrush="{StaticResource BorderBrush}"
                BorderThickness="1">
            <StackPanel Spacing="16">
                <TextBlock Text="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÑƒÑ€Ñ"
                           FontSize="18"
                           FontWeight="SemiBold"
                           Foreground="{StaticResource TextPrimaryBrush}" />
                
                <Grid ColumnDefinitions="*,Auto" >
                    <TextBox Grid.Column="0"
                             Text="{Binding NewCourseInput}"
                             Watermark="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ID ÐºÑƒÑ€ÑÐ° Ð¸Ð»Ð¸ URL (https://stepik.org/course/12345)"
                             Height="44"
                             CornerRadius="8"
                             FontSize="14"
                             Padding="12,0"
                             Margin="0,0,12,0" />
                    <Button Grid.Column="1"
                            Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÑƒÑ€Ñ"
                            Command="{Binding AddCourseCommand}"
                            IsEnabled="{Binding !IsAddingCourse}"
                            Height="44"
                            Padding="24,0"
                            Background="{StaticResource PrimaryBrush}"
                            Foreground="White"
                            FontWeight="SemiBold"
                            CornerRadius="8"
                            Cursor="Hand" />
                </Grid>
                
                <!-- Error message -->
                <TextBlock Text="{Binding ErrorMessage}"
                           IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                           Foreground="{StaticResource ErrorBrush}"
                           FontSize="13" />
            </StackPanel>
        </Border>
        
        <!-- Courses list -->
        <ScrollViewer Grid.Row="2">
            <StackPanel Spacing="16">
                <!-- Loading -->
                <TextBlock Text="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°..."
                           IsVisible="{Binding IsLoading}"
                           HorizontalAlignment="Center"
                           FontSize="16"
                           Foreground="{StaticResource TextSecondaryBrush}" />
                
                <!-- Empty state -->
                <Border IsVisible="{Binding !Courses.Count}"
                        Background="{StaticResource SubtleBrush}"
                        CornerRadius="12"
                        Padding="48"
                        HorizontalAlignment="Center">
                    <StackPanel HorizontalAlignment="Center" Spacing="12">
                        <TextBlock Text="ðŸ“š" FontSize="48" HorizontalAlignment="Center" />
                        <TextBlock Text="ÐšÑƒÑ€ÑÑ‹ Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   HorizontalAlignment="Center" />
                        <TextBlock Text="Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ð¹ ÐºÑƒÑ€Ñ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ"
                                   FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>
                
                <!-- Courses -->
                <ItemsControl ItemsSource="{Binding Courses}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{StaticResource PaperBrush}"
                                    CornerRadius="12"
                                    Padding="20"
                                    Margin="0,0,0,8"
                                    BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="1"
                                    Cursor="Hand">
                                <Grid ColumnDefinitions="*,Auto,Auto">
                                    <!-- Course info -->
                                    <StackPanel Grid.Column="0" Spacing="8">
                                        <TextBlock Text="{Binding Title}"
                                                   FontSize="18"
                                                   FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}" />
                                        <StackPanel Orientation="Horizontal" Spacing="16">
                                            <TextBlock FontSize="13" Foreground="{StaticResource TextSecondaryBrush}">
                                                <Run Text="ID: " />
                                                <Run Text="{Binding StepikCourseId}" FontWeight="Medium" />
                                            </TextBlock>
                                            <TextBlock FontSize="13" Foreground="{StaticResource TextMutedBrush}">
                                                <Run Text="ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ ÑÐ¸Ð½Ðº: " />
                                                <Run Text="{Binding LastSync.LastSyncAt, StringFormat={}{0:dd.MM.yyyy HH:mm}}" />
                                            </TextBlock>
                                        </StackPanel>
                                    </StackPanel>
                                    
                                    <!-- Open button -->
                                    <Button Grid.Column="1"
                                            Content="ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´"
                                            Command="{Binding $parent[ItemsControl].((vm:CoursesViewModel)DataContext).SelectCourseCommand}"
                                            CommandParameter="{Binding}"
                                            Height="40"
                                            Padding="20,0"
                                            Background="{StaticResource PrimaryBrush}"
                                            Foreground="White"
                                            FontWeight="Medium"
                                            CornerRadius="8"
                                            Margin="16,0" />
                                    
                                    <!-- Delete button -->
                                    <Button Grid.Column="2"
                                            Content="âœ•"
                                            Command="{Binding $parent[ItemsControl].((vm:CoursesViewModel)DataContext).DeleteCourseCommand}"
                                            CommandParameter="{Binding Id}"
                                            Width="40"
                                            Height="40"
                                            Background="Transparent"
                                            Foreground="{StaticResource TextMutedBrush}"
                                            FontSize="16"
                                            CornerRadius="8"
                                            ToolTip.Tip="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÑƒÑ€Ñ" />
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
